cmake_minimum_required(VERSION 3.31)
project(CatTests)

# ======================
# CTest ëª…ë ¹ì–´ë¡œ ì—¬ëŸ¬ê°œì˜ í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ í•œë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.
enable_testing()


# ======================
# GoogleTest í´ë” ì¶”ê°€ ğŸ‰
add_subdirectory(googletest)


# ======================
# í—¤ë” íŒŒì¼ ê¸°ë³¸ ê²€ìƒ‰ ê²½ë¡œ
include_directories(${CMAKE_SOURCE_DIR}/../include)
# âœ… iot.cc, Cat.cc, ë“± ì—¬ëŸ¬ê³³ì—ì„œ ì“°ì´ë¯€ë¡œ ê¸°ë³¸ ê²€ìƒ‰ ê²½ë¡œë¡œ ì„¤ì •í•œë‹¤.
include_directories(${CMAKE_SOURCE_DIR}/../libs)


# ======================
# ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§Œë“¤ê¸°
# ìµœìƒë‹¨ CMakeLists.txtì™€ëŠ” ë³„ê°œì˜ íŒŒì¼ì´ë¯€ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ì‹œ ì •ì˜í•œë‹¤.
add_library(iot_lib ${CMAKE_SOURCE_DIR}/../libs/iot.cc)
# í…ŒìŠ¤íŠ¸ ì½”ë“œ ì…ì¥ì—ì„œëŠ” í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” êµ¬í˜„ì²´ ì½”ë“œë„ ê²°êµ­ importí•´ì˜¤ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤.
add_library(cat_module ${CMAKE_SOURCE_DIR}/../src/Cat.cc)


# ======================
# í…ŒìŠ¤íŠ¸ íŒŒì¼ ìƒì„± ğŸ“
add_executable(CatTest CatTest.cc)


# ======================
# GoogleTest ë° GoogleMock ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§í¬
target_link_libraries(CatTest PRIVATE gtest_main gmock_main cat_module iot_lib)

# ======================
# CTest ëª…ë ¹ì–´ë¡œ ì—¬ëŸ¬ê°œì˜ í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ í•œë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.
add_test(NAME CatTest COMMAND CatTest)